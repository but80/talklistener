package main

var firLPF = [][]float64{
	// fc = 1.0
	{
		-8.073641e-05, -7.373281e-05, -6.679867e-05, -5.982777e-05, -5.270841e-05, -4.532363e-05, -3.755158e-05, -2.926580e-05, -2.033559e-05, -1.062635e-05,
		+4.339342e-20, +1.168466e-05, +2.457153e-05, +3.880674e-05, +5.453828e-05, +7.191549e-05, +9.108862e-05, +1.122083e-04, +1.354253e-04, +1.608896e-04,
		+1.887502e-04, +2.191547e-04, +2.522487e-04, +2.881750e-04, +3.270736e-04, +3.690809e-04, +4.143292e-04, +4.629466e-04, +5.150557e-04, +5.707741e-04,
		+6.302131e-04, +6.934778e-04, +7.606665e-04, +8.318701e-04, +9.071718e-04, +9.866470e-04, +1.070362e-03, +1.158376e-03, +1.250736e-03, +1.347482e-03,
		+1.448644e-03, +1.554241e-03, +1.664283e-03, +1.778767e-03, +1.897683e-03, +2.021007e-03, +2.148705e-03, +2.280733e-03, +2.417034e-03, +2.557540e-03,
		+2.702174e-03, +2.850844e-03, +3.003449e-03, +3.159878e-03, +3.320007e-03, +3.483700e-03, +3.650813e-03, +3.821191e-03, +3.994666e-03, +4.171063e-03,
		+4.350195e-03, +4.531866e-03, +4.715872e-03, +4.901999e-03, +5.090024e-03, +5.279717e-03, +5.470841e-03, +5.663150e-03, +5.856393e-03, +6.050311e-03,
		+6.244641e-03, +6.439115e-03, +6.633459e-03, +6.827397e-03, +7.020647e-03, +7.212928e-03, +7.403952e-03, +7.593434e-03, +7.781085e-03, +7.966618e-03,
		+8.149744e-03, +8.330178e-03, +8.507634e-03, +8.681829e-03, +8.852485e-03, +9.019324e-03, +9.182075e-03, +9.340471e-03, +9.494251e-03, +9.643159e-03,
		+9.786947e-03, +9.925373e-03, +1.005820e-02, +1.018521e-02, +1.030619e-02, +1.042092e-02, +1.052921e-02, +1.063087e-02, +1.072573e-02, +1.081363e-02,
		+1.089440e-02, +1.096792e-02, +1.103405e-02, +1.109267e-02, +1.114369e-02, +1.118701e-02, +1.122256e-02, +1.125027e-02, +1.127010e-02, +1.128202e-02,
		+1.128599e-02, +1.128202e-02, +1.127010e-02, +1.125027e-02, +1.122256e-02, +1.118701e-02, +1.114369e-02, +1.109267e-02, +1.103405e-02, +1.096792e-02,
		+1.089440e-02, +1.081363e-02, +1.072573e-02, +1.063087e-02, +1.052921e-02, +1.042092e-02, +1.030619e-02, +1.018521e-02, +1.005820e-02, +9.925373e-03,
		+9.786947e-03, +9.643159e-03, +9.494251e-03, +9.340471e-03, +9.182075e-03, +9.019324e-03, +8.852485e-03, +8.681829e-03, +8.507634e-03, +8.330178e-03,
		+8.149744e-03, +7.966618e-03, +7.781085e-03, +7.593434e-03, +7.403952e-03, +7.212928e-03, +7.020647e-03, +6.827397e-03, +6.633459e-03, +6.439115e-03,
		+6.244641e-03, +6.050311e-03, +5.856393e-03, +5.663150e-03, +5.470841e-03, +5.279717e-03, +5.090024e-03, +4.901999e-03, +4.715872e-03, +4.531866e-03,
		+4.350195e-03, +4.171063e-03, +3.994666e-03, +3.821191e-03, +3.650813e-03, +3.483700e-03, +3.320007e-03, +3.159878e-03, +3.003449e-03, +2.850844e-03,
		+2.702174e-03, +2.557540e-03, +2.417034e-03, +2.280733e-03, +2.148705e-03, +2.021007e-03, +1.897683e-03, +1.778767e-03, +1.664283e-03, +1.554241e-03,
		+1.448644e-03, +1.347482e-03, +1.250736e-03, +1.158376e-03, +1.070362e-03, +9.866470e-04, +9.071718e-04, +8.318701e-04, +7.606665e-04, +6.934778e-04,
		+6.302131e-04, +5.707741e-04, +5.150557e-04, +4.629466e-04, +4.143292e-04, +3.690809e-04, +3.270736e-04, +2.881750e-04, +2.522487e-04, +2.191547e-04,
		+1.887502e-04, +1.608896e-04, +1.354253e-04, +1.122083e-04, +9.108862e-05, +7.191549e-05, +5.453828e-05, +3.880674e-05, +2.457153e-05, +1.168466e-05,
		+4.339342e-20, -1.062635e-05, -2.033559e-05, -2.926580e-05, -3.755158e-05, -4.532363e-05, -5.270841e-05, -5.982777e-05, -6.679867e-05, -7.373281e-05,
		-8.073641e-05,
	},
	// fc = 1.5
	{
		-2.073108e-04, -2.145038e-04, -2.224038e-04, -2.310709e-04, -2.405535e-04, -2.508867e-04, -2.620924e-04, -2.741776e-04, -2.871342e-04, -3.009382e-04,
		-3.155491e-04, -3.309095e-04, -3.469447e-04, -3.635621e-04, -3.806516e-04, -3.980846e-04, -4.157151e-04, -4.333787e-04, -4.508936e-04, -4.680605e-04,
		-4.846629e-04, -5.004682e-04, -5.152276e-04, -5.286773e-04, -5.405391e-04, -5.505214e-04, -5.583201e-04, -5.636201e-04, -5.660959e-04, -5.654133e-04,
		-5.612306e-04, -5.532001e-04, -5.409697e-04, -5.241840e-04, -5.024868e-04, -4.755217e-04, -4.429346e-04, -4.043753e-04, -3.594988e-04, -3.079678e-04,
		-2.494539e-04, -1.836398e-04, -1.102209e-04, -2.890694e-05, +6.057590e-05, +1.584835e-04, +2.650522e-04, +3.804969e-04, +5.050098e-04, +6.387587e-04,
		+7.818855e-04, +9.345053e-04, +1.096704e-03, +1.268540e-03, +1.450038e-03, +1.641194e-03, +1.841969e-03, +2.052294e-03, +2.272064e-03, +2.501141e-03,
		+2.739350e-03, +2.986486e-03, +3.242305e-03, +3.506530e-03, +3.778850e-03, +4.058919e-03, +4.346359e-03, +4.640757e-03, +4.941670e-03, +5.248622e-03,
		+5.561109e-03, +5.878595e-03, +6.200521e-03, +6.526298e-03, +6.855314e-03, +7.186935e-03, +7.520505e-03, +7.855349e-03, +8.190776e-03, +8.526079e-03,
		+8.860539e-03, +9.193426e-03, +9.524002e-03, +9.851524e-03, +1.017524e-02, +1.049441e-02, +1.080829e-02, +1.111613e-02, +1.141719e-02, +1.171075e-02,
		+1.199610e-02, +1.227253e-02, +1.253936e-02, +1.279593e-02, +1.304158e-02, +1.327570e-02, +1.349770e-02, +1.370700e-02, +1.390306e-02, +1.408539e-02,
		+1.425351e-02, +1.440697e-02, +1.454539e-02, +1.466839e-02, +1.477566e-02, +1.486691e-02, +1.494190e-02, +1.500043e-02, +1.504235e-02, +1.506755e-02,
		+1.507595e-02, +1.506755e-02, +1.504235e-02, +1.500043e-02, +1.494190e-02, +1.486691e-02, +1.477566e-02, +1.466839e-02, +1.454539e-02, +1.440697e-02,
		+1.425351e-02, +1.408539e-02, +1.390306e-02, +1.370700e-02, +1.349770e-02, +1.327570e-02, +1.304158e-02, +1.279593e-02, +1.253936e-02, +1.227253e-02,
		+1.199610e-02, +1.171075e-02, +1.141719e-02, +1.111613e-02, +1.080829e-02, +1.049441e-02, +1.017524e-02, +9.851524e-03, +9.524002e-03, +9.193426e-03,
		+8.860539e-03, +8.526079e-03, +8.190776e-03, +7.855349e-03, +7.520505e-03, +7.186935e-03, +6.855314e-03, +6.526298e-03, +6.200521e-03, +5.878595e-03,
		+5.561109e-03, +5.248622e-03, +4.941670e-03, +4.640757e-03, +4.346359e-03, +4.058919e-03, +3.778850e-03, +3.506530e-03, +3.242305e-03, +2.986486e-03,
		+2.739350e-03, +2.501141e-03, +2.272064e-03, +2.052294e-03, +1.841969e-03, +1.641194e-03, +1.450038e-03, +1.268540e-03, +1.096704e-03, +9.345053e-04,
		+7.818855e-04, +6.387587e-04, +5.050098e-04, +3.804969e-04, +2.650522e-04, +1.584835e-04, +6.057590e-05, -2.890694e-05, -1.102209e-04, -1.836398e-04,
		-2.494539e-04, -3.079678e-04, -3.594988e-04, -4.043753e-04, -4.429346e-04, -4.755217e-04, -5.024868e-04, -5.241840e-04, -5.409697e-04, -5.532001e-04,
		-5.612306e-04, -5.654133e-04, -5.660959e-04, -5.636201e-04, -5.583201e-04, -5.505214e-04, -5.405391e-04, -5.286773e-04, -5.152276e-04, -5.004682e-04,
		-4.846629e-04, -4.680605e-04, -4.508936e-04, -4.333787e-04, -4.157151e-04, -3.980846e-04, -3.806516e-04, -3.635621e-04, -3.469447e-04, -3.309095e-04,
		-3.155491e-04, -3.009382e-04, -2.871342e-04, -2.741776e-04, -2.620924e-04, -2.508867e-04, -2.405535e-04, -2.310709e-04, -2.224038e-04, -2.145038e-04,
		-2.073108e-04,
	},
	// fc = 2.0
	{
		+1.356453e-04, +1.250818e-04, +1.142967e-04, +1.031442e-04, +9.146344e-05, +7.908130e-05, +6.581415e-05, +5.147044e-05, +3.585321e-05, +1.876286e-05,
		-7.665721e-20, -2.063151e-05, -4.332149e-05, -6.825031e-05, -9.558560e-05, -1.254791e-04, -1.580636e-04, -1.934493e-04, -2.317212e-04, -2.729361e-04,
		-3.171194e-04, -3.642626e-04, -4.143206e-04, -4.672098e-04, -5.228055e-04, -5.809403e-04, -6.414028e-04, -7.039357e-04, -7.682357e-04, -8.339523e-04,
		-9.006876e-04, -9.679970e-04, -1.035389e-03, -1.102326e-03, -1.168228e-03, -1.232469e-03, -1.294384e-03, -1.353271e-03, -1.408390e-03, -1.458971e-03,
		-1.504213e-03, -1.543293e-03, -1.575363e-03, -1.599563e-03, -1.615020e-03, -1.620853e-03, -1.616183e-03, -1.600132e-03, -1.571834e-03, -1.530437e-03,
		-1.475111e-03, -1.405054e-03, -1.319494e-03, -1.217703e-03, -1.098992e-03, -9.627252e-04, -8.083232e-04, -6.352663e-04, -4.431020e-04, -2.314485e-04,
		+4.705640e-19, +2.514691e-04, +5.231006e-04, +8.149488e-04, +1.126977e-03, +1.459057e-03, +1.810963e-03, +2.182373e-03, +2.572868e-03, +2.981928e-03,
		+3.408937e-03, +3.853178e-03, +4.313840e-03, +4.790011e-03, +5.280692e-03, +5.784788e-03, +6.301120e-03, +6.828424e-03, +7.365355e-03, +7.910498e-03,
		+8.462366e-03, +9.019408e-03, +9.580018e-03, +1.014254e-02, +1.070527e-02, +1.126648e-02, +1.182439e-02, +1.237723e-02, +1.292320e-02, +1.346049e-02,
		+1.398730e-02, +1.450186e-02, +1.500240e-02, +1.548718e-02, +1.595450e-02, +1.640273e-02, +1.683025e-02, +1.723553e-02, +1.761711e-02, +1.797360e-02,
		+1.830370e-02, +1.860619e-02, +1.887995e-02, +1.912397e-02, +1.933733e-02, +1.951925e-02, +1.966903e-02, +1.978611e-02, +1.987006e-02, +1.992056e-02,
		+1.993741e-02, +1.992056e-02, +1.987006e-02, +1.978611e-02, +1.966903e-02, +1.951925e-02, +1.933733e-02, +1.912397e-02, +1.887995e-02, +1.860619e-02,
		+1.830370e-02, +1.797360e-02, +1.761711e-02, +1.723553e-02, +1.683025e-02, +1.640273e-02, +1.595450e-02, +1.548718e-02, +1.500240e-02, +1.450186e-02,
		+1.398730e-02, +1.346049e-02, +1.292320e-02, +1.237723e-02, +1.182439e-02, +1.126648e-02, +1.070527e-02, +1.014254e-02, +9.580018e-03, +9.019408e-03,
		+8.462366e-03, +7.910498e-03, +7.365355e-03, +6.828424e-03, +6.301120e-03, +5.784788e-03, +5.280692e-03, +4.790011e-03, +4.313840e-03, +3.853178e-03,
		+3.408937e-03, +2.981928e-03, +2.572868e-03, +2.182373e-03, +1.810963e-03, +1.459057e-03, +1.126977e-03, +8.149488e-04, +5.231006e-04, +2.514691e-04,
		+4.705640e-19, -2.314485e-04, -4.431020e-04, -6.352663e-04, -8.083232e-04, -9.627252e-04, -1.098992e-03, -1.217703e-03, -1.319494e-03, -1.405054e-03,
		-1.475111e-03, -1.530437e-03, -1.571834e-03, -1.600132e-03, -1.616183e-03, -1.620853e-03, -1.615020e-03, -1.599563e-03, -1.575363e-03, -1.543293e-03,
		-1.504213e-03, -1.458971e-03, -1.408390e-03, -1.353271e-03, -1.294384e-03, -1.232469e-03, -1.168228e-03, -1.102326e-03, -1.035389e-03, -9.679970e-04,
		-9.006876e-04, -8.339523e-04, -7.682357e-04, -7.039357e-04, -6.414028e-04, -5.809403e-04, -5.228055e-04, -4.672098e-04, -4.143206e-04, -3.642626e-04,
		-3.171194e-04, -2.729361e-04, -2.317212e-04, -1.934493e-04, -1.580636e-04, -1.254791e-04, -9.558560e-05, -6.825031e-05, -4.332149e-05, -2.063151e-05,
		-7.665721e-20, +1.876286e-05, +3.585321e-05, +5.147044e-05, +6.581415e-05, +7.908130e-05, +9.146344e-05, +1.031442e-04, +1.142967e-04, +1.250818e-04,
		+1.356453e-04,
	},
}

func convolve(wave, ir []float64) []float64 {
	result := make([]float64, len(wave))
	if len(wave) == 0 {
		return result
	}
	base := wave[0]
	for i := range wave {
		result[i] = base
		for j, r := range ir {
			if j <= i {
				result[i] += r * (wave[i-j] - base)
			}
		}
	}
	return result
}
